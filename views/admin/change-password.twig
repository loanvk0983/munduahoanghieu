{% extends 'layouts/admin.twig' %}

{% block title %}ƒê·ªïi M·∫≠t Kh·∫©u{% endblock %}

{% block content %}
<div class="p-8">
  <!-- Header -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-2">üîë ƒê·ªïi M·∫≠t Kh·∫©u</h1>
    <p class="text-gray-600">Thay ƒë·ªïi m·∫≠t kh·∫©u ƒëƒÉng nh·∫≠p c·ªßa b·∫°n</p>
  </div>

  <!-- Success/Error Messages -->
  {% if success %}
    <div class="mb-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg relative">
      <span class="block sm:inline">‚úÖ {{ success }}</span>
    </div>
  {% endif %}

  {% if error %}
    <div class="mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative">
      <span class="block sm:inline">‚ùå {{ error }}</span>
    </div>
  {% endif %}

  <div class="max-w-2xl">
    <!-- Change Password Form -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <form method="POST" action="/admin/change-password" class="space-y-6">
        <input type="hidden" name="_csrf" value="{{ csrfToken }}">
        
        <!-- Current Password -->
        <div>
          <label for="currentPassword" class="block text-sm font-medium text-gray-700 mb-2">
            M·∫≠t kh·∫©u hi·ªán t·∫°i <span class="text-red-500">*</span>
          </label>
          <input type="password" id="currentPassword" name="currentPassword" required
                 class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                 placeholder="Nh·∫≠p m·∫≠t kh·∫©u hi·ªán t·∫°i">
        </div>
        
        <!-- New Password -->
        <div>
          <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-2">
            M·∫≠t kh·∫©u m·ªõi <span class="text-red-500">*</span>
          </label>
          <input type="password" id="newPassword" name="newPassword" required minlength="6"
                 class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                 placeholder="T·ªëi thi·ªÉu 6 k√Ω t·ª±">
          <p class="mt-1 text-sm text-gray-500">M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±</p>
        </div>
        
        <!-- Confirm Password -->
        <div>
          <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-2">
            X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi <span class="text-red-500">*</span>
          </label>
          <input type="password" id="confirmPassword" name="confirmPassword" required minlength="6"
                 class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                 placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi">
        </div>
        
        <!-- Submit Button -->
        <div class="flex gap-4">
          <button type="submit"
                  class="bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-3 rounded-lg transition-colors">
            üîí ƒê·ªïi M·∫≠t Kh·∫©u
          </button>
          
          <a href="/admin/dashboard"
             class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-6 py-3 rounded-lg transition-colors inline-block">
            ‚Üê Quay l·∫°i
          </a>
        </div>
      </form>
    </div>

    <!-- Security Tips -->
    <div class="mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
      <div class="flex">
        <div class="flex-shrink-0">
          <span class="text-2xl">üõ°Ô∏è</span>
        </div>
        <div class="ml-3">
          <h3 class="text-sm font-semibold text-yellow-800 mb-2">M·∫πo b·∫£o m·∫≠t:</h3>
          <ul class="text-sm text-yellow-700 space-y-1">
            <li>‚Ä¢ S·ª≠ d·ª•ng m·∫≠t kh·∫©u m·∫°nh v·ªõi ch·ªØ hoa, ch·ªØ th∆∞·ªùng, s·ªë v√† k√Ω t·ª± ƒë·∫∑c bi·ªát</li>
            <li>‚Ä¢ Kh√¥ng d√πng m·∫≠t kh·∫©u d·ªÖ ƒëo√°n nh∆∞ ng√†y sinh, t√™n, s·ªë ƒëi·ªán tho·∫°i</li>
            <li>‚Ä¢ Kh√¥ng chia s·∫ª m·∫≠t kh·∫©u v·ªõi ng∆∞·ªùi kh√°c</li>
            <li>‚Ä¢ Thay ƒë·ªïi m·∫≠t kh·∫©u ƒë·ªãnh k·ª≥ (3-6 th√°ng/l·∫ßn)</li>
            <li>‚Ä¢ Kh√¥ng d√πng l·∫°i m·∫≠t kh·∫©u c≈© ƒë√£ t·ª´ng s·ª≠ d·ª•ng</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Account Info -->
    <div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
      <div class="flex items-center">
        <div class="w-12 h-12 rounded-full bg-green-600 flex items-center justify-center text-white font-bold text-xl mr-4">
          {{ user.username[0]|upper }}
        </div>
        <div>
          <p class="text-sm font-medium text-gray-700">T√†i kho·∫£n hi·ªán t·∫°i:</p>
          <p class="text-lg font-bold text-gray-900">{{ user.username }}</p>
          <p class="text-sm text-gray-600">Vai tr√≤: <span class="font-semibold">{{ user.role|capitalize }}</span></p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Client-side validation -->
<script>
  document.querySelector('form').addEventListener('submit', function(e) {
    const newPassword = document.getElementById('newPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    
    if (newPassword !== confirmPassword) {
      e.preventDefault();
      alert('‚ùå M·∫≠t kh·∫©u m·ªõi v√† x√°c nh·∫≠n m·∫≠t kh·∫©u kh√¥ng kh·ªõp!');
      return false;
    }
    
    if (newPassword.length < 6) {
      e.preventDefault();
      alert('‚ùå M·∫≠t kh·∫©u m·ªõi ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±!');
      return false;
    }
  });
</script>
{% endblock %}
